module.exports.pageResult = function(results, page, perPage) {
  var start = getStartInternal(page, perPage)  var end = getEndInternal(page, perPage)  return results.slice(start, end)}module.exports.getStart = getStartInternalfunction getStartInternal(page, perPage) {  var _page = page  var _perPage = perPage  if (!page) {    _page = 1  }  if (!perPage) {    _perPage = 1000  }  return parseInt(_page - 1) * _perPage}function getEndInternal(page, perPage) {  var _page = page  var _perPage = perPage  if (!page) {    _page = 1  }  if (!perPage) {    _perPage = 1000  }  return parseInt(_page) * _perPage}module.exports.trimTailingSlash = function (x) {  return x.replace(/\/$/gm,'');}module.exports.aggInternal = function(req, res, next, map, reduce, prop, groupby) {  req.collection.mapReduce(map, reduce, {query: req.body, scope: {property: prop, group: groupby}, out: {replace : 'replaceThisCollection'}}, function(e, outCollection) {    if (e) {      console.log(e)    }    outCollection.find().toArray(function(e, results) {      res.send(results)      next()    })  })}